<head>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <link href='/media-player.css' rel='stylesheet' />
</head>

<body class="body-bg">
    <!-- view video modal -->
    <div class="center-modal">
        <%- include("viewVideo.ejs") %>
    </div>

    <div class="container d-flex align-items-center overflow-auto">
        <table class="table table-striped table-hover m-3">
            <thead>
                <tr>
                    <th class="col text-center" id="#">#</th>
                    <th class="col text-center" id="Name">Name </th>
                    <th class="col text-center" id="Status">Status</th>
                    <th class="col text-center" id="Details">Details</th>
                </tr>
            </thead>
            <tbody>
                <% if (members.length!=0) { %>
                    <% members.forEach((member, index)=> { %>
                        <tr id=<%=index %>>
                            <th class="text-center" scope="row">
                                <%= index+1 %>
                            </th>
                            <td class="text-center">
                                <%= member.firstName %>
                                    <span> </span>
                                    <%= member.lastName %>
                            </td>
                            <td class="text-center status">
                                <% if(member.status===true) {%>
                                    <span id="status">Fallen!</span>

                                    <% } else if(member.status===false) { %>
                                        <span id="status">All Good!</span>
                                        <% } %>
                                            <% if(member.status===true ) { %>
                                                <span class='d-inline-flex mb-0 circle status-indicator-fall'></span>
                                                <% } else if(member.status===false ) { %>
                                                    <span
                                                        class='d-inline-flex mb-0 circle status-indicator-good'></span>
                                                    <% } %>
                            </td>
                            <td class="text-center">
                                <a class="modal-trigger viewDetails" href="#viewMemberDetailsModal">View
                                    Details</a>
                            </td>
                            <td class="text-center">
                                <% if(member.status===true) { %>
                                    <a class='modal-trigger' href='#videoCapture'><i
                                            class="small material-icons viewMemberVideo"
                                            id="viewMemberVideo">ondemand_video</i></a>
                                    <% } %>
                            </td>
                        </tr>
                        <% }) %>
                            <% } %>
            </tbody>
        </table>
    </div>
    <script>
        var isExpert = `<%- isExpert %>`;
        var currentSelectedrowID;
        //Load Member Video
        $('.viewMemberVideo').click(function (event) {
            event.preventDefault();
            currentSelectedrowID = event.target.parentNode.parentNode.parentNode.id;
            var mems = '<%- JSON.stringify(members) %>';
            mems = JSON.parse(mems);

            $('#viewMemberVideoSource').attr('src', mems[currentSelectedrowID].videoURL);
            $('#video')[0].load();
        });
    </script>
    <script src='/js/media-player.js'></script>
    <script src='/js/forward-video.js'></script>
</body>